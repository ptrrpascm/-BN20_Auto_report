<Activity mc:Ignorable="sap sap2010" x:Class="Main" VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="1200.8,961.6" sap2010:WorkflowViewState.IdRef="ActivityBuilder_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:njl="clr-namespace:Newtonsoft.Json.Linq;assembly=Newtonsoft.Json" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=System.Private.CoreLib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data.Common" xmlns:si="clr-namespace:System.IO;assembly=System.Private.CoreLib" xmlns:uasc="clr-namespace:UiPath.Activities.System.Collections;assembly=UiPath.System.Activities" xmlns:ue="clr-namespace:UiPath.Excel;assembly=UiPath.Excel.Activities" xmlns:ueab="clr-namespace:UiPath.Excel.Activities.Business;assembly=UiPath.Excel.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:um="clr-namespace:UiPath.Mail;assembly=UiPath.Mail.Activities" xmlns:umab="clr-namespace:UiPath.Mail.Activities.Business;assembly=UiPath.Mail.Activities" xmlns:umabh="clr-namespace:UiPath.Mail.Activities.Business.HtmlEditor;assembly=UiPath.Mail.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>System.Linq.Expressions</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>System.Dynamic</x:String>
      <x:String>System.Collections.Specialized</x:String>
      <x:String>UiPath.Shared.Activities.Business</x:String>
      <x:String>UiPath.Excel.Activities.Business</x:String>
      <x:String>UiPath.Excel.Model</x:String>
      <x:String>UiPath.Shared.Activities</x:String>
      <x:String>System.Numerics</x:String>
      <x:String>UiPath.DataTableUtilities</x:String>
      <x:String>UiPath.Activities.System.Collections</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>UiPath.Mail.Outlook.Activities</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>UiPath.Mail.Activities.Business</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail.Models</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail.Enums</x:String>
      <x:String>UiPath.Shared.Activities.Utils</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities.Mail</x:String>
      <x:String>UiPath.Shared.Activities.ConnectionService.Contracts</x:String>
      <x:String>UiPath.MicrosoftOffice365.Activities</x:String>
      <x:String>UiPath.Mail.Activities.Utils</x:String>
      <x:String>UiPath.Mail.Activities.Business.HtmlEditor</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Drawing.Common</AssemblyReference>
      <AssemblyReference>System.Drawing.Primitives</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Net.Mail</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>System.Reflection.DispatchProxy</AssemblyReference>
      <AssemblyReference>System.Reflection.TypeExtensions</AssemblyReference>
      <AssemblyReference>System.Reflection.Metadata</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Primitives</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.Private.Xml</AssemblyReference>
      <AssemblyReference>System.ComponentModel.EventBasedAsync</AssemblyReference>
      <AssemblyReference>System.Private.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Formatters</AssemblyReference>
      <AssemblyReference>System.Private.DataContractSerialization</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Primitives</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Workflow</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>System.Memory.Data</AssemblyReference>
      <AssemblyReference>System.Console</AssemblyReference>
      <AssemblyReference>System.Security.Permissions</AssemblyReference>
      <AssemblyReference>System.Configuration.ConfigurationManager</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Private.Uri</AssemblyReference>
      <AssemblyReference>System.Linq.Expressions</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>System.Data.SqlClient</AssemblyReference>
      <AssemblyReference>System.Linq.Async</AssemblyReference>
      <AssemblyReference>System.Linq.Async.Queryable</AssemblyReference>
      <AssemblyReference>System.Linq.Parallel</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.Linq.Queryable</AssemblyReference>
      <AssemblyReference>System.Collections</AssemblyReference>
      <AssemblyReference>System.Collections.NonGeneric</AssemblyReference>
      <AssemblyReference>System.Collections.Specialized</AssemblyReference>
      <AssemblyReference>System.CodeDom</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Forms</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic.Core</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Testing.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.Watcher</AssemblyReference>
      <AssemblyReference>System.IO.Packaging</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.AccessControl</AssemblyReference>
      <AssemblyReference>System.IO.FileSystem.DriveInfo</AssemblyReference>
      <AssemblyReference>System.Runtime.Numerics</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.MicrosoftOffice365.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>System.Text.RegularExpressions</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="Main Sequence" sap:VirtualizedContainerService.HintSize="662.4,736.8" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart sap:VirtualizedContainerService.HintSize="1080,813.6" sap2010:WorkflowViewState.IdRef="Flowchart_1">
      <Flowchart.Variables>
        <Variable x:TypeArguments="x:String" Name="_path_trigger" />
        <Variable x:TypeArguments="x:String" Name="_date_exc" />
        <Variable x:TypeArguments="x:String" Name="_img_adrees_root" />
        <Variable x:TypeArguments="x:String" Name="_attachment_adrees_root" />
        <Variable x:TypeArguments="x:Boolean" Name="IsTriggerJob" />
        <Variable x:TypeArguments="x:String" Name="_ROOT_output_sharepoint" />
      </Flowchart.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <av:Point x:Key="ShapeLocation">275,35</av:Point>
          <av:Size x:Key="ShapeSize">49.6,49.6</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">300,85 300,145</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Flowchart.StartNode>
        <x:Reference>__ReferenceID4</x:Reference>
      </Flowchart.StartNode>
      <FlowStep>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">245,495</av:Point>
            <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence sap2010:Annotation.AnnotationText="Split job by&#xA;&gt;Bill&#xA;    &gt;Container&#xD;&#xA;&#xD;&#xA;Arg: _date_exc" DisplayName="[PY] Split bill and con" sap:VirtualizedContainerService.HintSize="110.4,70.4" sap2010:WorkflowViewState.IdRef="Sequence_2">
          <Sequence.Variables>
            <Variable x:TypeArguments="x:String" Name="py_exc_name" />
            <Variable x:TypeArguments="x:String" Name="export_ziplog_path" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_1">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[py_exc_name]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[$"split_bill_con.py {_date_exc}"]</InArgument>
            </Assign.Value>
          </Assign>
          <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_16">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[export_ziplog_path]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">C:\\py_lab\\py_execute\\exc_log\\splitJOB_log_</InArgument>
            </Assign.Value>
          </Assign>
          <ui:StartProcess WorkingDirectory="{x:Null}" sap2010:Annotation.AnnotationText="2&gt;&amp;1 เป็นการบอกว่า &quot;ส่ง standard error (2) ไปยังที่เดียวกับที่ standard output (1)&quot;" Arguments="[$&quot;/c set PYTHONIOENCODING=utf-8 &amp; py C:\\py_lab\\py_execute\\BN20_py\\{py_exc_name} &gt;&gt; {export_ziplog_path}&quot; &amp; Date.Now.ToString(&quot;yyyy_MM_dd&quot;) &amp; &quot;.txt 2&gt;&amp;1&quot;]" DisplayName="Start Process - cmd Syncronously" FileName="C:\Windows\System32\cmd.exe" sap:VirtualizedContainerService.HintSize="433.6,164" sap2010:WorkflowViewState.IdRef="StartProcess_1" StartType="Synchronously" Timeout="10000">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:StartProcess>
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="433.6,165.6" sap2010:WorkflowViewState.IdRef="LogMessage_12" Message="[&quot;Running...&quot; &amp; py_exc_name]" />
        </Sequence>
      </FlowStep>
      <FlowStep>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">935,45</av:Point>
            <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">420,474.02 420,504.02</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence sap2010:Annotation.AnnotationText="Mock at Date&#xA;24 Oct 2025" DisplayName="Read trigger xlsx " sap:VirtualizedContainerService.HintSize="110.4,70.4" sap2010:WorkflowViewState.IdRef="Sequence_3">
          <Sequence.Variables>
            <Variable x:TypeArguments="sd:DataTable" Name="UniqueDataTable" />
            <Variable x:TypeArguments="sd:DataTable" Name="triggerXLSX" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ueab:ExcelProcessScopeX FileConflictResolution="{x:Null}" MacroSettings="{x:Null}" DisplayAlerts="False" DisplayName="Excel Process Scope" ExistingProcessAction="ForceKill" sap:VirtualizedContainerService.HintSize="636,992" sap2010:WorkflowViewState.IdRef="ExcelProcessScopeX_1" LaunchMethod="Application" LaunchTimeout="30000" ProcessMode="AlwaysCreateNew" ShowExcelWindow="False">
            <ueab:ExcelProcessScopeX.Body>
              <ActivityAction x:TypeArguments="ui:IExcelProcess">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="ui:IExcelProcess" Name="ExcelProcessScopeTag" />
                </ActivityAction.Argument>
                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="602,873" sap2010:WorkflowViewState.IdRef="Sequence_14">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ueab:ExcelApplicationCard Password="{x:Null}" ReadFormatting="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Use Excel File" sap:VirtualizedContainerService.HintSize="540,785" sap2010:WorkflowViewState.IdRef="ExcelApplicationCard_1" ResizeWindow="None" WorkbookPath="[$&quot;{_path_trigger}\{_date_exc}\Trigger.xlsx&quot;]">
                    <ueab:ExcelApplicationCard.Body>
                      <ActivityAction x:TypeArguments="ue:IWorkbookQuickHandle">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="ue:IWorkbookQuickHandle" Name="Excel" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="506,493" sap2010:WorkflowViewState.IdRef="Sequence_13">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ueab:ReadRangeX DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="444,201" sap2010:WorkflowViewState.IdRef="ReadRangeX_1" Range="[Excel.Sheet(&quot;Sheet1&quot;)]" SaveTo="[triggerXLSX]" />
                          <Assign sap2010:Annotation.AnnotationText="Group unique&#xA;- Client name &amp; Container &amp; Date" sap:VirtualizedContainerService.HintSize="444,156" sap2010:WorkflowViewState.IdRef="Assign_7">
                            <Assign.To>
                              <OutArgument x:TypeArguments="sd:DataTable">[UniqueDataTable]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="sd:DataTable">[(From row In triggerXLSX.AsEnumerable() Group row By Key = New With { Key .A = row.Field(Of String)("ClientName"), Key .B = row.Field(Of String)("ContainerNo"), Key .C = row.Field(Of String)("RecDate") } Into Group Select Group.First()).CopyToDataTable()]</InArgument>
                            </Assign.Value>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </Assign>
                          <ui:CommentOut DisplayName="Read by obj JSON" sap:VirtualizedContainerService.HintSize="444,48" sap2010:WorkflowViewState.IdRef="CommentOut_5">
                            <ui:CommentOut.Body>
                              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="592,811" sap2010:WorkflowViewState.IdRef="Sequence_9">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[UniqueDataTable]" DisplayName="For Each Row in Data Table" sap:VirtualizedContainerService.HintSize="530,723" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                                  <ui:ForEachRow.Body>
                                    <ActivityAction x:TypeArguments="sd:DataRow">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CurrentRow" />
                                      </ActivityAction.Argument>
                                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="496,536" sap2010:WorkflowViewState.IdRef="Sequence_8">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Assign sap:VirtualizedContainerService.HintSize="434,115" sap2010:WorkflowViewState.IdRef="Assign_8">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="njl:JObject">[row_obj]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="njl:JObject" xml:space="preserve">[New Newtonsoft.Json.Linq.JObject( _
    New Newtonsoft.Json.Linq.JProperty("ContainerNo", CurrentRow("ContainerNo").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("InvoiceNo", CurrentRow("InvoiceNo").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("MaterialDev", CurrentRow("MaterialDev").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("MaterialDmg", CurrentRow("MaterialDmg").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("ProductName", CurrentRow("ProductName").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("QtyDamage", CInt(CurrentRow("QtyDamage").ToString())), _
    New Newtonsoft.Json.Linq.JProperty("QtyDev", CInt(CurrentRow("QtyDev").ToString())), _
    New Newtonsoft.Json.Linq.JProperty("RecDate", CurrentRow("RecDate").ToString().Replace("-", "_") ), _
    New Newtonsoft.Json.Linq.JProperty("Status", CurrentRow("Status").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("isDone", CInt(CurrentRow("isDone").ToString())), _
    New Newtonsoft.Json.Linq.JProperty("defect_grp", CurrentRow("defect_grp").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("defect_reason", CurrentRow("defect_reason").ToString()), _
    New Newtonsoft.Json.Linq.JProperty("inbound_delivery", CurrentRow("inbound_delivery").ToString()) _
)]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_9">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[img_path]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[$"{_img_adrees_root}\{row_obj("ProductName").ToString()}\{row_obj("ContainerNo").ToString()}\{row_obj("RecDate").ToString()}"]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_10">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[attachment_path]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[$"{_attachment_adrees_root}\{row_obj("RecDate").ToString()}\{row_obj("ProductName").ToString()}\{row_obj("ContainerNo").ToString()}"]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="434,57" sap2010:WorkflowViewState.IdRef="CommentOut_3">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="416,252" sap2010:WorkflowViewState.IdRef="Sequence_6">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="354,164" sap2010:WorkflowViewState.IdRef="LogMessage_2" Message="[$&quot;IMG Target =&gt; {_img_adrees_root}\{row_obj(&quot;ProductName&quot;).ToString()}\{row_obj(&quot;ContainerNo&quot;).ToString()}\{row_obj(&quot;RecDate&quot;).ToString()}&quot;]" />
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="434,48" sap2010:WorkflowViewState.IdRef="CommentOut_4">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="416,254.4" sap2010:WorkflowViewState.IdRef="Sequence_7">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="353.6,165.6" sap2010:WorkflowViewState.IdRef="LogMessage_3" Message="[$&quot;File Target =&gt; {_attachment_adrees_root}\{row_obj(&quot;RecDate&quot;).ToString()}\{row_obj(&quot;ProductName&quot;).ToString()}\{row_obj(&quot;ContainerNo&quot;).ToString()}&quot;]" />
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                      </Sequence>
                                    </ActivityAction>
                                  </ui:ForEachRow.Body>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:ForEachRow>
                              </Sequence>
                            </ui:CommentOut.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:CommentOut>
                        </Sequence>
                      </ActivityAction>
                    </ueab:ExcelApplicationCard.Body>
                  </ueab:ExcelApplicationCard>
                </Sequence>
              </ActivityAction>
            </ueab:ExcelProcessScopeX.Body>
          </ueab:ExcelProcessScopeX>
          <Sequence DisplayName="table to text" sap:VirtualizedContainerService.HintSize="636,336" sap2010:WorkflowViewState.IdRef="Sequence_18">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:String" Name="_tmp_trigger" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:OutputDataTable DataTable="[triggerXLSX]" DisplayName="Output Data Table as Text" sap:VirtualizedContainerService.HintSize="388,112" sap2010:WorkflowViewState.IdRef="OutputDataTable_1" Text="[_tmp_trigger]" />
            <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="388,113" sap2010:WorkflowViewState.IdRef="WriteLine_1" Text="[_tmp_trigger]" />
          </Sequence>
        </Sequence>
      </FlowStep>
      <FlowStep x:Name="__ReferenceID0">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">495,375</av:Point>
            <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ui:LogMessage DisplayName="When FALSE" sap:VirtualizedContainerService.HintSize="110.4,70.4" sap2010:WorkflowViewState.IdRef="LogMessage_7" Message="[&quot;FALSE JA ‍♂️‍&quot; &amp; Environment.NewLine &amp;&#xA;&quot;NO TRIGGER JOB TO BE DONE&quot; &amp; vbNewLine &amp; &quot;NEW LINE&quot;]">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </ui:LogMessage>
      </FlowStep>
      <FlowDecision x:Name="__ReferenceID1" Condition="[IsTriggerJob = True]" DisplayName="Do Have job today?" sap:VirtualizedContainerService.HintSize="60,60" sap2010:WorkflowViewState.IdRef="FlowDecision_1">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <av:Point x:Key="ShapeLocation">270,380</av:Point>
            <av:Size x:Key="ShapeSize">60,60</av:Size>
            <av:PointCollection x:Key="TrueConnector">300,440 300,470 435,470 435,660.2 465,660.2</av:PointCollection>
            <av:PointCollection x:Key="FalseConnector">330,410 360,410 360,410.2 495,410.2</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <FlowDecision.True>
          <FlowStep x:Name="__ReferenceID3">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:Point x:Key="ShapeLocation">465,625</av:Point>
                <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Sequence DisplayName="[EMAIL] Loop table by client" sap:VirtualizedContainerService.HintSize="942.4,7458.4" sap2010:WorkflowViewState.IdRef="Sequence_23">
              <Sequence.Variables>
                <Variable x:TypeArguments="x:String" Name="_cur_job_path" />
                <Variable x:TypeArguments="scg:List(x:String)" Name="ListClient" />
                <Variable x:TypeArguments="sd:DataTable" Name="tb_by_client_raw" />
                <Variable x:TypeArguments="x:Int32" Name="intUniqueInvoiceCount" />
                <Variable x:TypeArguments="x:Int32" Name="intUniqueContainerCount" />
                <Variable x:TypeArguments="x:String" Name="strEmailBodyLinks" />
                <Variable x:TypeArguments="sd:DataTable" Name="dtGroupedResult" />
                <Variable x:TypeArguments="x:String" Name="_email_to_send" />
                <Variable x:TypeArguments="sd:DataTable" Name="dtCleanedData" />
                <Variable x:TypeArguments="sd:DataTable" Name="tb_no_headers" />
                <Variable x:TypeArguments="sd:DataTable" Name="dt_select" />
                <Variable x:TypeArguments="x:String" Name="txt_dtUniq" />
                <Variable x:TypeArguments="x:String" Name="strHtml" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Assign sap:VirtualizedContainerService.HintSize="880,113.6" sap2010:WorkflowViewState.IdRef="Assign_20">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:String">[_cur_job_path]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:String">[$"{_path_trigger}\{_date_exc}\job_log"]</InArgument>
                </Assign.Value>
              </Assign>
              <Sequence DisplayName="Look up master email" sap:VirtualizedContainerService.HintSize="880,225.6" sap2010:WorkflowViewState.IdRef="Sequence_37">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign sap:VirtualizedContainerService.HintSize="433.6,104.8" sap2010:WorkflowViewState.IdRef="Assign_38">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[_email_to_send]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">pattarawut.chaona@dksh.com</InArgument>
                  </Assign.Value>
                </Assign>
              </Sequence>
              <ui:ForEachFileX DisplayName="For Each File in Folder - by client" Filter="*.xlsx" Folder="[_cur_job_path]" sap:VirtualizedContainerService.HintSize="880,7030.4" sap2010:WorkflowViewState.IdRef="ForEachFileX_1" IncludeSubDirectories="False" OrderBy="NameAscFirst" SkipFolderWithoutPermission="False">
                <ui:ForEachFileX.Body>
                  <ActivityAction x:TypeArguments="si:FileInfo, x:Int32">
                    <ActivityAction.Argument1>
                      <DelegateInArgument x:TypeArguments="si:FileInfo" Name="CurrentFile" />
                    </ActivityAction.Argument1>
                    <ActivityAction.Argument2>
                      <DelegateInArgument x:TypeArguments="x:Int32" Name="CurrentIndex" />
                    </ActivityAction.Argument2>
                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="846.4,6744" sap2010:WorkflowViewState.IdRef="Sequence_24">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:String" Name="strSummaryText" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="784,174.4" sap2010:WorkflowViewState.IdRef="LogMessage_15" Message="[&quot;╰(*°▽°*)╯ Start =&gt; &quot; &amp; CurrentFile.Name &amp; &quot;...&quot;]" />
                      <ueab:ExcelProcessScopeX FileConflictResolution="{x:Null}" LaunchMethod="{x:Null}" DisplayAlerts="False" DisplayName="Excel Process Scope" ExistingProcessAction="ForceKill" sap:VirtualizedContainerService.HintSize="784,4227.2" sap2010:WorkflowViewState.IdRef="ExcelProcessScopeX_2" LaunchTimeout="30000" MacroSettings="DisableAll" ProcessMode="AlwaysCreateNew" ShowExcelWindow="False">
                        <ueab:ExcelProcessScopeX.Body>
                          <ActivityAction x:TypeArguments="ui:IExcelProcess">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="ui:IExcelProcess" Name="ExcelProcessScopeTag" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="750.4,4108.8" sap2010:WorkflowViewState.IdRef="Sequence_25">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ueab:ExcelApplicationCard Password="{x:Null}" ReadFormatting="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Use Excel File" sap:VirtualizedContainerService.HintSize="688,4020" sap2010:WorkflowViewState.IdRef="ExcelApplicationCard_2" ResizeWindow="None" WorkbookPath="[CurrentFile.FullName]">
                                <ueab:ExcelApplicationCard.Body>
                                  <ActivityAction x:TypeArguments="ue:IWorkbookQuickHandle">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="ue:IWorkbookQuickHandle" Name="Excel" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="654.4,3727.2" sap2010:WorkflowViewState.IdRef="Sequence_26">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="sd:DataTable" Name="dtUniqueData" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ueab:ReadRangeX DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="592,201.6" sap2010:WorkflowViewState.IdRef="ReadRangeX_2" Range="[Excel.Sheet(&quot;Sheet1&quot;)]" SaveTo="[tb_by_client_raw]" />
                                      <ui:BuildDataTable DataTable="[dtGroupedResult]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="592,92" sap2010:WorkflowViewState.IdRef="BuildDataTable_1" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;ReceiveDate&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;UniqueInvoiceCount&quot; msdata:Caption=&quot;&quot; type=&quot;xs:int&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;UniqueContainerCount&quot; msdata:Caption=&quot;&quot; type=&quot;xs:int&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                                      <Assign sap:VirtualizedContainerService.HintSize="592,115.2" sap2010:WorkflowViewState.IdRef="Assign_36">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="sd:DataTable">[dtGroupedResult]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="sd:DataTable" xml:space="preserve">[(From row In tb_by_client_raw.AsEnumerable()
Group row By ReceiveDateFormatted = DateTime.Parse(CStr(row("ReceiveDate")).Trim()).ToString("yyyy-MM-dd") Into Group
Select dtGroupedResult.Clone().LoadDataRow(
    New Object() {
        ReceiveDateFormatted,
        Group.Select(Function(g) If(IsDBNull(g("InvoiceNo")), Nothing, g("InvoiceNo"))).Distinct().Count(),
        Group.Select(Function(g) If(IsDBNull(g("ContainerNo")), Nothing, g("ContainerNo"))).Distinct().Count()
    }, False)).CopyToDataTable()]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign sap:VirtualizedContainerService.HintSize="592,113.6" sap2010:WorkflowViewState.IdRef="Assign_21">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="sd:DataTable">[dtUniqueData]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="sd:DataTable">[tb_by_client_raw.DefaultView.ToTable(True, "ClientName","ReceiveDate", "InvoiceNo", "ContainerNo")]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:OutputDataTable DataTable="[tb_by_client_raw]" DisplayName="Output Data Table as Text" sap:VirtualizedContainerService.HintSize="592,112.8" sap2010:WorkflowViewState.IdRef="OutputDataTable_2" Text="[txt_dtUniq]" />
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="592,174.4" sap2010:WorkflowViewState.IdRef="LogMessage_18" Message="[&quot;table to txt (raw) &quot; &amp; vbCrLf &amp; txt_dtUniq]" />
                                      <Assign sap:VirtualizedContainerService.HintSize="592,113.6" sap2010:WorkflowViewState.IdRef="Assign_31">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[intUniqueInvoiceCount]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">[tb_by_client_raw.DefaultView.ToTable(True, "InvoiceNo").Rows.Count]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign sap:VirtualizedContainerService.HintSize="592,113.6" sap2010:WorkflowViewState.IdRef="Assign_32">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[intUniqueContainerCount]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">[tb_by_client_raw.DefaultView.ToTable(True, "ContainerNo").Rows.Count]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign sap:VirtualizedContainerService.HintSize="592,113.6" sap2010:WorkflowViewState.IdRef="Assign_33">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="scg:List(x:String)">[ListClient]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="scg:List(x:String)">[New List(Of String)]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtUniqueData]" DisplayName="For Each Row in Data Table - Extract variable" sap:VirtualizedContainerService.HintSize="592,1472" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                                        <ui:ForEachRow.Body>
                                          <ActivityAction x:TypeArguments="sd:DataRow">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="CurrentRow" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="558.4,1274.4" sap2010:WorkflowViewState.IdRef="Sequence_28">
                                              <Sequence.Variables>
                                                <Variable x:TypeArguments="x:String" Name="strMonth" />
                                                <Variable x:TypeArguments="x:String" Name="strDay" />
                                                <Variable x:TypeArguments="x:String" Name="cl_name" />
                                                <Variable x:TypeArguments="x:String" Name="Root_sp" />
                                                <Variable x:TypeArguments="x:String" Name="job_url" />
                                                <Variable x:TypeArguments="x:String" Name="inv_no" />
                                                <Variable x:TypeArguments="x:String" Name="con_no" />
                                              </Sequence.Variables>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="Extract date and var pack" sap:VirtualizedContainerService.HintSize="496,1020.8" sap2010:WorkflowViewState.IdRef="Sequence_27">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="s:DateTime" Name="dtReceive" />
                                                  <Variable x:TypeArguments="x:String" Name="strYear" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_22">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="s:DateTime">[dtReceive]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="s:DateTime">[DateTime.Parse(CurrentRow("ReceiveDate").ToString)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_23">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strYear]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[dtReceive.Year.ToString]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_24">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strMonth]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[dtReceive.Month.ToString("00")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_25">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[strDay]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[dtReceive.Day.ToString("00")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_26">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[cl_name]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[CurrentRow("ClientName").ToString]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_29">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[inv_no]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[CurrentRow("InvoiceNo").ToString]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_30">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[con_no]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[CurrentRow("ContainerNo").ToString]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="433.6,104.8" sap2010:WorkflowViewState.IdRef="Assign_27">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[job_url]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[$"{_ROOT_output_sharepoint}/{cl_name}/{strYear}/{strMonth}/{strDay}/{inv_no}/{con_no}"]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <uasc:AppendItemToCollection x:TypeArguments="x:String" Collection="[ListClient]" DisplayName="Append Items to Collection" sap:VirtualizedContainerService.HintSize="496,164.8" sap2010:WorkflowViewState.IdRef="AppendItemToCollection`1_1">
                                                <uasc:AppendItemToCollection.Items>
                                                  <scg:List x:TypeArguments="InArgument(x:String)" Capacity="4">
                                                    <InArgument x:TypeArguments="x:String">[job_url]</InArgument>
                                                  </scg:List>
                                                </uasc:AppendItemToCollection.Items>
                                              </uasc:AppendItemToCollection>
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:ForEachRow.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ForEachRow>
                                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="592,56.8" sap2010:WorkflowViewState.IdRef="CommentOut_9">
                                        <ui:CommentOut.Body>
                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="512,426" sap2010:WorkflowViewState.IdRef="Sequence_33">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each currentText" sap:VirtualizedContainerService.HintSize="450,338" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[ListClient]">
                                              <ui:ForEach.Body>
                                                <ActivityAction x:TypeArguments="x:String">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:String" Name="currentText" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="416,201" sap2010:WorkflowViewState.IdRef="Sequence_30">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="354,113" sap2010:WorkflowViewState.IdRef="WriteLine_6" Text="[currentText]" />
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:ForEach.Body>
                                            </ui:ForEach>
                                          </Sequence>
                                        </ui:CommentOut.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:CommentOut>
                                      <Assign sap:VirtualizedContainerService.HintSize="592,115.2" sap2010:WorkflowViewState.IdRef="Assign_34">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[strEmailBodyLinks]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String" xml:space="preserve">[String.Join("&lt;br&gt;", ListClient.Select(Function(link) "&lt;A href='" &amp; link &amp; "'&gt;" &amp; _
System.Text.RegularExpressions.Regex.Match(link, "(?&lt;Invoice&gt;[^\/]+)/(?&lt;Container&gt;[^\/]+)$").Groups("Invoice").Value &amp; "_" &amp;  _
System.Text.RegularExpressions.Regex.Match(link, "(?&lt;Invoice&gt;[^\/]+)/(?&lt;Container&gt;[^\/]+)$").Groups("Container").Value _
&amp; "&lt;/A&gt;"))]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:CommentOut DisplayName="Comment Out - Read again for table fill in email" sap:VirtualizedContainerService.HintSize="592,56.8" sap2010:WorkflowViewState.IdRef="CommentOut_15">
                                        <ui:CommentOut.Body>
                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="568,393" sap2010:WorkflowViewState.IdRef="Sequence_49">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Sequence DisplayName="Read again for table fill in email" sap:VirtualizedContainerService.HintSize="506,305" sap2010:WorkflowViewState.IdRef="Sequence_46">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ueab:ReadRangeX DisplayName="Read Range" HasHeaders="False" sap:VirtualizedContainerService.HintSize="444,194" sap2010:WorkflowViewState.IdRef="ReadRangeX_6" Range="[Excel.Sheet(&quot;Sheet1&quot;)]" SaveTo="[tb_no_headers]" />
                                            </Sequence>
                                          </Sequence>
                                        </ui:CommentOut.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:CommentOut>
                                      <Sequence DisplayName="Convert table to HTML" sap:VirtualizedContainerService.HintSize="592,787.2" sap2010:WorkflowViewState.IdRef="Sequence_48">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:InvokeCode ContinueOnError="{x:Null}" Code="' ใช้ ByVal และ ByRef สำหรับ Argument ที่กำหนดใน Properties Panel&#xA;' dtInput คือ DataTable ที่เข้ามา&#xA;' strHtmlTable คือ String HTML ที่ส่งออกไป&#xA;&#xA;Dim htmlTable As String = &quot;&lt;table border='1' cellpadding='5' style='border-collapse: collapse; font-family: Tahoma, sans-serif; font-size: 10pt; width: 100%;'&gt;&quot;&#xA;&#xA;' 1. สร้าง Header (&lt;thead&gt;)&#xA;htmlTable &amp;= &quot;&lt;thead&gt;&lt;tr style='background-color: #EEEEEE;'&gt;&quot;&#xA;For Each column As DataColumn In dtInput.Columns&#xA;    htmlTable &amp;= &quot;&lt;th&gt;&quot; &amp; column.ColumnName &amp; &quot;&lt;/th&gt;&quot;&#xA;Next&#xA;htmlTable &amp;= &quot;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&quot;&#xA;&#xA;' 2. สร้าง Data Rows (&lt;tbody&gt;)&#xA;For Each row As DataRow In dtInput.Rows&#xA;    htmlTable &amp;= &quot;&lt;tr&gt;&quot;&#xA;    For Each item In row.ItemArray&#xA;        ' ตรวจสอบค่า Null และแปลงเป็น String&#xA;        Dim cellValue As String = If(item Is DBNull.Value, &quot;&quot;, item.ToString())&#xA;        htmlTable &amp;= &quot;&lt;td&gt;&quot; &amp; cellValue &amp; &quot;&lt;/td&gt;&quot;&#xA;    Next&#xA;    htmlTable &amp;= &quot;&lt;/tr&gt;&quot;&#xA;Next&#xA;&#xA;htmlTable &amp;= &quot;&lt;/tbody&gt;&lt;/table&gt;&quot;&#xA;&#xA;' กำหนดผลลัพธ์&#xA;strHtmlTable = htmlTable" DisplayName="Invoke Code" sap:VirtualizedContainerService.HintSize="451.2,196.8" sap2010:WorkflowViewState.IdRef="InvokeCode_3">
                                          <ui:InvokeCode.Arguments>
                                            <InArgument x:TypeArguments="sd:DataTable" x:Key="dtInput">[tb_by_client_raw]</InArgument>
                                            <OutArgument x:TypeArguments="x:String" x:Key="strHtmlTable">[strHtml]</OutArgument>
                                          </ui:InvokeCode.Arguments>
                                        </ui:InvokeCode>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="451.2,312.8" sap2010:WorkflowViewState.IdRef="CommentOut_16">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="416,202.4" sap2010:WorkflowViewState.IdRef="Sequence_50">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="353.6,113.6" sap2010:WorkflowViewState.IdRef="WriteLine_11" Text="[strHtml]" />
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                        </ui:CommentOut>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="451.2,165.6" sap2010:WorkflowViewState.IdRef="LogMessage_19" Message="[&quot;Convert table to html DONE...&quot;]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:LogMessage>
                                      </Sequence>
                                    </Sequence>
                                  </ActivityAction>
                                </ueab:ExcelApplicationCard.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ueab:ExcelApplicationCard>
                            </Sequence>
                          </ActivityAction>
                        </ueab:ExcelProcessScopeX.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ueab:ExcelProcessScopeX>
                      <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[dtGroupedResult]" DisplayName="For Each Row in Data Table - Summarize text" sap:VirtualizedContainerService.HintSize="784,391.2" sap2010:WorkflowViewState.IdRef="ForEachRow_3">
                        <ui:ForEachRow.Body>
                          <ActivityAction x:TypeArguments="sd:DataRow">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="496,193.6" sap2010:WorkflowViewState.IdRef="Sequence_36">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="433.6,104.8" sap2010:WorkflowViewState.IdRef="Assign_37">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[strSummaryText]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[strSummaryText + "วันที่ " + row("ReceiveDate").ToString + " จำนวน Container " + row("UniqueContainerCount").ToString + " ตู้" + "&lt;br&gt;"]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </ActivityAction>
                        </ui:ForEachRow.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:ForEachRow>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="784,174.4" sap2010:WorkflowViewState.IdRef="LogMessage_17" Level="Trace" Message="[&quot;Summarize =&gt; &quot; &amp; strSummaryText]" />
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="784,174.4" sap2010:WorkflowViewState.IdRef="LogMessage_14" Level="Info" Message="[&quot;LINK =&gt; &quot; &amp; strEmailBodyLinks]" />
                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="784,56.8" sap2010:WorkflowViewState.IdRef="CommentOut_11">
                        <ui:CommentOut.Body>
                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="558,632" sap2010:WorkflowViewState.IdRef="Sequence_41">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Sequence DisplayName="Prep table email" sap:VirtualizedContainerService.HintSize="496,544" sap2010:WorkflowViewState.IdRef="Sequence_40">
                              <Sequence.Variables>
                                <Variable x:TypeArguments="x:String" Name="strHeaders" />
                                <Variable x:TypeArguments="x:String" Name="strFinalTableText" />
                              </Sequence.Variables>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:BuildDataTable DataTable="[dtCleanedData]" DisplayName="Build Data Table" sap:VirtualizedContainerService.HintSize="434,92" sap2010:WorkflowViewState.IdRef="BuildDataTable_2" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;ReceiveDate&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;ClientName&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;InvoiceNo&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;ContainerNo&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;MaterialDefect&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;QtyDefect&quot; msdata:Caption=&quot;&quot; type=&quot;xs:int&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;DefectGroup&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;DefectReason&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;MaterialSampling&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;FullQty&quot; msdata:Caption=&quot;&quot; type=&quot;xs:int&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;RemainQty&quot; msdata:Caption=&quot;&quot; type=&quot;xs:int&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Inbound_no&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;                &lt;xs:element name=&quot;Status&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                              <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_39">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sd:DataTable">[dtCleanedData]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="sd:DataTable">[(From row In tb_by_client_raw.AsEnumerable() Select dtCleanedData.Clone().LoadDataRow(New Object() {DateTime.Parse(CStr(row("ReceiveDate")).Trim()).ToString("yyyy-MM-dd"), row("ClientName"), row("InvoiceNo"), row("ContainerNo"), row("MaterialDefect"), row("QtyDefect"), row("DefectGroup"), row("DefectReason"), row("MaterialSampling"), row("FullQty"), row("RemainQty"), row("Inbound_no"), row("Status")}, False)).CopyToDataTable()]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign sap:VirtualizedContainerService.HintSize="434,114" sap2010:WorkflowViewState.IdRef="Assign_40">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[strHeaders]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[String.Join(vbTab, dtCleanedData.Columns.Cast(Of System.Data.DataColumn)().Select(Function(c) c.ColumnName))]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="434,113" sap2010:WorkflowViewState.IdRef="WriteLine_7" Text="[strHeaders]" />
                            </Sequence>
                          </Sequence>
                        </ui:CommentOut.Body>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:CommentOut>
                      <Sequence DisplayName="Send EMAIL" sap:VirtualizedContainerService.HintSize="784,1291.2" sap2010:WorkflowViewState.IdRef="Sequence_38">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <umab:OutlookApplicationCard Account="{x:Null}" AccountMismatchBehavior="UseDefaultEmailAccount" DisplayName="Use Desktop Outlook App" sap:VirtualizedContainerService.HintSize="627.2,1170.4" sap2010:WorkflowViewState.IdRef="OutlookApplicationCard_1">
                          <umab:OutlookApplicationCard.Body>
                            <ActivityAction x:TypeArguments="um:IMailQuickHandle">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="um:IMailQuickHandle" Name="Outlook" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="593.6,965.6" sap2010:WorkflowViewState.IdRef="Sequence_39">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="x:String" Name="strFinalHtmlBody" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign sap:VirtualizedContainerService.HintSize="531.2,115.2" sap2010:WorkflowViewState.IdRef="Assign_41">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[strFinalHtmlBody]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">[$"&lt;p style=""font-family: Tahoma, Arial, sans-serif; font-size: 15pt;""&gt;Dear all,&lt;/p&gt;

&lt;p class=&amp;quot;header-text&amp;quot;&gt;รายระเอียดการรับสินค้า&lt;/p&gt;
&lt;p style=""font-family: Tahoma, Arial, sans-serif; color: #113F67;""&gt;{strSummaryText}&lt;/p&gt;

&lt;p class=&amp;quot;header-text&amp;quot;&gt;เอกสารการรับสินค้า&lt;/p&gt;
{strEmailBodyLinks}

&lt;p&gt;รายละเอียดเพิ่มเติมดังตาราง&lt;/p&gt;
{strHtml}

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p style=""font-family: Tahoma, Arial, sans-serif; font-size: 15pt; color: #659287;""&gt;Best, regards&lt;/p&gt;
&lt;p style=""font-family: Tahoma, Arial, sans-serif; font-size: 15pt; color: #5D688A;""&gt;SCM RPA&lt;/p&gt;"]</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <ui:SendOutlookMail Account="{x:Null}" Bcc="{x:Null}" Cc="{x:Null}" ContinueOnError="{x:Null}" MailMessage="{x:Null}" ReplyTo="{x:Null}" TimeoutMS="{x:Null}" Body="[strFinalHtmlBody]" DisplayName="Send Outlook Mail Message" sap:VirtualizedContainerService.HintSize="531.2,178.4" sap2010:WorkflowViewState.IdRef="SendOutlookMail_1" Importance="Normal" IsBodyHtml="True" IsDraft="True" Sensitivity="Normal" Subject="[tb_by_client_raw.Rows(0)(&quot;ClientName&quot;).ToString() + &quot; Report executed at &quot; + Today.ToString(&quot;yyyy-MM-dd&quot;)]" To="[_email_to_send]">
                                  <ui:SendOutlookMail.Files>
                                    <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                  </ui:SendOutlookMail.Files>
                                </ui:SendOutlookMail>
                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="531.2,583.2" sap2010:WorkflowViewState.IdRef="CommentOut_14">
                                  <ui:CommentOut.Body>
                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="496,481.6" sap2010:WorkflowViewState.IdRef="Sequence_47">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <umab:SendMailX Bcc="{x:Null}" Body="{x:Null}" Cc="{x:Null}" HtmlBodyFromText="{x:Null}" ReplyTo="{x:Null}" Account="[Outlook]" DisplayName="Send Email" sap:VirtualizedContainerService.HintSize="433.6,392.8" sap2010:WorkflowViewState.IdRef="SendMailX_2" Importance="Normal" MaxBodyDocumentSizeMB="2" Sensitivity="Normal" Subject="[tb_by_client_raw.Rows(0)(&quot;ClientName&quot;).ToString() + &quot; Report&quot;]" To="[_email_to_send]" UseDocumentAsBody="False">
                                        <umab:SendMailX.Files>
                                          <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                        </umab:SendMailX.Files>
                                        <umab:SendMailX.HtmlBodyFromFile>
                                          <umabh:HtmlContentArgument HtmlBody="{x:Null}" FilePath=".data/HtmlContent0.html">
                                            <umabh:HtmlContentArgument.RuntimeImages>
                                              <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                            </umabh:HtmlContentArgument.RuntimeImages>
                                            <umabh:HtmlContentArgument.ValueMappings>
                                              <scg:List x:TypeArguments="umabh:HtmlValueMappingBase" Capacity="4">
                                                <umabh:HtmlTextValueMapping Name="strSummary" Value="[strSummaryText]" />
                                                <umabh:HtmlTextValueMapping Name="addr_folder" Value="[strEmailBodyLinks]" />
                                                <umabh:HtmlTableValueMapping Name="Table" Value="[tb_no_headers]" />
                                                <umabh:HtmlTextValueMapping Name="Value" Value="[strHtml]" />
                                              </scg:List>
                                            </umabh:HtmlContentArgument.ValueMappings>
                                          </umabh:HtmlContentArgument>
                                        </umab:SendMailX.HtmlBodyFromFile>
                                      </umab:SendMailX>
                                    </Sequence>
                                  </ui:CommentOut.Body>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:CommentOut>
                              </Sequence>
                            </ActivityAction>
                          </umab:OutlookApplicationCard.Body>
                        </umab:OutlookApplicationCard>
                      </Sequence>
                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="784,165.6" sap2010:WorkflowViewState.IdRef="LogMessage_16" Message="[&quot;## END File &quot; &amp; CurrentFile.Name &amp; &quot;... ##&quot;]" />
                    </Sequence>
                  </ActivityAction>
                </ui:ForEachFileX.Body>
              </ui:ForEachFileX>
            </Sequence>
          </FlowStep>
        </FlowDecision.True>
        <FlowDecision.False>
          <x:Reference>__ReferenceID0</x:Reference>
        </FlowDecision.False>
      </FlowDecision>
      <FlowStep x:Name="__ReferenceID2">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">245,265</av:Point>
            <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,335 300,365 299.5,365 299.5,380</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence sap2010:Annotation.AnnotationText="report_history\{_date_exc}\Trigger.csv &#xA;isExist?" DisplayName="Check job is exist" sap:VirtualizedContainerService.HintSize="110.4,70.4" sap2010:WorkflowViewState.IdRef="Sequence_19">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:FileExistsX DisplayName="File Exists" Exists="[IsTriggerJob]" sap:VirtualizedContainerService.HintSize="388,165" sap2010:WorkflowViewState.IdRef="FileExistsX_1" Path="[$&quot;{_path_trigger}\{_date_exc}\Trigger.xlsx&quot;]" />
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="388,164" sap2010:WorkflowViewState.IdRef="LogMessage_8" Level="Info" Message="[$&quot;Find path: =&gt; {_path_trigger}\{_date_exc}\Trigger.xlsx&quot; &amp; Environment.NewLine &amp;&#xA;&quot;Trigger job status is =&gt; &quot; &amp; IsTriggerJob]" />
        </Sequence>
        <FlowStep.Next>
          <x:Reference>__ReferenceID1</x:Reference>
        </FlowStep.Next>
      </FlowStep>
      <FlowStep x:Name="__ReferenceID4">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">245,145</av:Point>
            <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,215 300,265</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence sap2010:Annotation.AnnotationText="Init variable&#xA;_path_trigger&#xA;_date_exc&#xA;_img_adrees_root&#xA;_attachment_adrees_root" DisplayName="Init var" sap:VirtualizedContainerService.HintSize="110.4,70.4" sap2010:WorkflowViewState.IdRef="Sequence_20">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign sap2010:Annotation.AnnotationText="Root report_history" sap:VirtualizedContainerService.HintSize="433.6,144.8" sap2010:WorkflowViewState.IdRef="Assign_12">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[_path_trigger]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">D:\SharePoint\OneDrive - DKSH\CG-A4 - BN_WorkingFolder\BN20\report_history</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
          <Assign sap2010:Annotation.AnnotationText="Date config manual" sap:VirtualizedContainerService.HintSize="433.6,144.8" sap2010:WorkflowViewState.IdRef="Assign_13">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[_date_exc]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">2025_11_04</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
          <Assign sap2010:Annotation.AnnotationText="Root img &#xA;Aware: Sharepoint path" sap:VirtualizedContainerService.HintSize="433.6,157.6" sap2010:WorkflowViewState.IdRef="Assign_14">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[_img_adrees_root]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">D:\SharePoint\OneDrive - DKSH\CG-A4 - BN_WorkingFolder\BN20\client_img</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
          <Assign sap2010:Annotation.AnnotationText="Root attachment" sap:VirtualizedContainerService.HintSize="433.6,144.8" sap2010:WorkflowViewState.IdRef="Assign_15">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[_attachment_adrees_root]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">D:\SharePoint\OneDrive - DKSH\CG-A4 - BN_WorkingFolder\BN20\attachment</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
          <Assign sap2010:Annotation.AnnotationText="Beware dev and prd sharepoint path !" sap:VirtualizedContainerService.HintSize="433.6,136" sap2010:WorkflowViewState.IdRef="Assign_28">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[_ROOT_output_sharepoint]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">https://dksh.sharepoint.com/sites/THCS/scmrpa/CG/RPA_InSnap/BN20/report</InArgument>
            </Assign.Value>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Assign>
        </Sequence>
        <FlowStep.Next>
          <x:Reference>__ReferenceID2</x:Reference>
        </FlowStep.Next>
      </FlowStep>
      <FlowStep>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">495,495</av:Point>
            <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence sap2010:Annotation.AnnotationText="Fill img &amp; table&#xA;export report&#xD;&#xA;&#xD;&#xA;Arg: _date_exc" DisplayName="[PY] Gen_report" sap:VirtualizedContainerService.HintSize="110.4,70.4" sap2010:WorkflowViewState.IdRef="Sequence_22">
          <Sequence.Variables>
            <Variable x:TypeArguments="x:String" Name="pyexc_path" />
            <Variable x:TypeArguments="x:String" Name="export_log_path" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsAnnotationDocked">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_17">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[pyexc_path]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[$"C:\\py_lab\\py_execute\\py_fill_report.py {_date_exc}"]</InArgument>
            </Assign.Value>
          </Assign>
          <Assign sap:VirtualizedContainerService.HintSize="433.6,113.6" sap2010:WorkflowViewState.IdRef="Assign_18">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[export_log_path]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">C:\\py_lab\\py_execute\\exc_log\\BN20_report_log_</InArgument>
            </Assign.Value>
          </Assign>
          <ui:StartProcess WorkingDirectory="{x:Null}" sap2010:Annotation.AnnotationText="2&gt;&amp;1 เป็นการบอกว่า &quot;ส่ง standard error (2) ไปยังที่เดียวกับที่ standard output (1)&quot;" Arguments="[$&quot;/c py {pyexc_path} &gt;&gt; {export_log_path}&quot; &amp; Date.Now.ToString(&quot;yyyy_MM_dd&quot;) &amp; &quot;.txt 2&gt;&amp;1&quot;]" DisplayName="CMD - Synchronous" FileName="C:\Windows\System32\cmd.exe" sap:VirtualizedContainerService.HintSize="433.6,164" sap2010:WorkflowViewState.IdRef="StartProcess_2" StartType="Synchronously" Timeout="10000">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </ui:StartProcess>
          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="433.6,165.6" sap2010:WorkflowViewState.IdRef="LogMessage_10" Message="[&quot;Running python... At&quot; &amp; pyexc_path]" />
        </Sequence>
      </FlowStep>
      <x:Reference>__ReferenceID3</x:Reference>
      <FlowStep>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">925,145</av:Point>
            <av:Size x:Key="ShapeSize">110.4,70.4</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence DisplayName="Convert table to HTML" sap:VirtualizedContainerService.HintSize="110.4,70.4" sap2010:WorkflowViewState.IdRef="Sequence_45">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ueab:ReadRangeX DisplayName="Read Range" HasHeaders="False" sap:VirtualizedContainerService.HintSize="444,201" sap2010:WorkflowViewState.IdRef="ReadRangeX_4" Range="[Excel.Sheet(&quot;Sheet1&quot;)]" SaveTo="[tb_no_headers]" />
          <ui:InvokeCode ContinueOnError="{x:Null}" Code="Dim lines As String() = Argument1.Split(New String() {Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries)&#xA;Dim htmlTable As String = &quot;&lt;table border='1' cellpadding='5' style='border-collapse: collapse; font-family: Arial, sans-serif; font-size: 10pt;'&gt;&quot;&#xA;&#xA;' 1. สร้าง Header&#xA;' *** ใช้ตัวคั่น Pipe | ***&#xA;Dim headers As String() = lines(0).Split(&quot;|&quot;c)&#xA;htmlTable &amp;= &quot;&lt;thead&gt;&lt;tr style='background-color: #f2f2f2;'&gt;&quot;&#xA;For Each header In headers&#xA;    ' *** ลบเครื่องหมายคำพูด และ Trim ***&#xA;    htmlTable &amp;= &quot;&lt;th&gt;&quot; &amp; header.Replace(&quot;&quot;&quot;&quot;, &quot;&quot;).Trim() &amp; &quot;&lt;/th&gt;&quot;&#xA;Next&#xA;htmlTable &amp;= &quot;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&quot;&#xA;&#xA;' 2. สร้าง Data Rows&#xA;For i As Integer = 1 To lines.Length - 1&#xA;    ' *** ใช้ตัวคั่น Pipe | ***&#xA;    Dim data() As String = lines(i).Split(&quot;|&quot;c)&#xA;    htmlTable &amp;= &quot;&lt;tr&gt;&quot;&#xA;    For Each item In data&#xA;        ' *** ลบเครื่องหมายคำพูด และ Trim ***&#xA;        htmlTable &amp;= &quot;&lt;td&gt;&quot; &amp; item.Replace(&quot;&quot;&quot;&quot;, &quot;&quot;).Trim() &amp; &quot;&lt;/td&gt;&quot;&#xA;    Next&#xA;    htmlTable &amp;= &quot;&lt;/tr&gt;&quot;&#xA;Next&#xA;&#xA;htmlTable &amp;= &quot;&lt;/tbody&gt;&lt;/table&gt;&quot;&#xA;Argument2 = htmlTable" DisplayName="Invoke Code" sap:VirtualizedContainerService.HintSize="444,197" sap2010:WorkflowViewState.IdRef="InvokeCode_2">
            <ui:InvokeCode.Arguments>
              <InArgument x:TypeArguments="x:String" x:Key="Argument1">[txt_dtUniq]</InArgument>
              <OutArgument x:TypeArguments="x:String" x:Key="Argument2">[strHtml]</OutArgument>
            </ui:InvokeCode.Arguments>
          </ui:InvokeCode>
          <WriteLine DisplayName="Write Line" sap:VirtualizedContainerService.HintSize="444,113" sap2010:WorkflowViewState.IdRef="WriteLine_10" Text="[strHtml]" />
        </Sequence>
      </FlowStep>
    </Flowchart>
  </Sequence>
</Activity>